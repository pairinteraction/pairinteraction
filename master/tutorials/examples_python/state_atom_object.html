

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StateAtom Objects &mdash; PairInteraction 2.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../../_static/gallery.css?v=4a1cd419" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=67b02a41"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=ccdb6887"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Effective Hamiltonian" href="effective_hamiltonian.html" />
    <link rel="prev" title="\(C_3\) and \(C_6\) Coefficients" href="c3_c6_coefficients.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PairInteraction
              <img src="../../_static/logo48x48.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">

              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#tutorials-python-api">Tutorials - Python API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="stark_map.html">Stark Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="pair_potentials.html">Pair Potentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lifetimes.html">Lifetimes</a></li>
<li class="toctree-l3"><a class="reference internal" href="c3_c6_coefficients.html"><span class="math notranslate nohighlight">\(C_3\)</span> and <span class="math notranslate nohighlight">\(C_6\)</span> Coefficients</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">StateAtom Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simple-example:-create-a-superposition">Simple example: create a superposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Use-state-objects-to-calculate-overlaps-and-expectation-values">Use state objects to calculate overlaps and expectation values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Stark-map-with-overlap-to-a-superposition-state">Stark map with overlap to a superposition state</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="effective_hamiltonian.html">Effective Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="pair_potential_efield_sensitivity.html">Pair Potentials Under External Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="atom_ion_interaction.html">Rydberg Atom Ion Interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="mqdt.html">MQDT Calculations for Ytterbium</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#tutorials-graphical-user-interface">Tutorials - Graphical User Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publications/publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">FAQs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributor Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/getting_started.html">Getting Started as a Contributor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/architecture.html">Overview of PairInteraction’s Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/style_guide.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/database.html">Database Format</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utility Tools [External Links]</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pairinteraction/MQDT.jl">MQDT.jl</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pairinteraction/rydstate">RydState</a></li>
</ul>

<style>
a.gitbutton {
  display: block;
  font-size: 18px;
  line-height: 1.5;
  color: #fff;
  padding-top: 10px;
  padding-left: 85px;
  padding-right: 0px;
  margin: 22px;
  width: 240px;
  height: 60px;
  background: transparent url("../../_static/buttons/github.svg") 0 0 no-repeat;
}
a.gitbutton small {
  display: block;
  font-size: 11px;
}
button.toctree-expand {
  display: none;
}
</style>
<a href="https://github.com/pairinteraction/pairinteraction" class="gitbutton">Explore<small>the GitHub repository</small></a>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PairInteraction</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">StateAtom Objects</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/examples_python/state_atom_object.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
  .nbinput .prompt,
  .nboutput .prompt {
    display: none;
  }

  .rst-content p {
    margin-bottom: 15px;
  }

  .rst-content div.nbinput.nblast.docutils.container + p,
  .rst-content div.nboutput.nblast.docutils.container + p {
    margin-top: 15px;
  }
</style>

<div class="admonition note">
  This page was generated from the Jupyter notebook
  <a class="reference external" href="state_atom_object.ipynb">state_atom_object.ipynb</a>.
  Open in
  <a class="reference external" href="https://colab.research.google.com/github/pairinteraction/pairinteraction/blob/master/docs/tutorials/examples_python/state_atom_object.ipynb">Google Colab</a>.
</div><section id="StateAtom-Objects">
<h1>StateAtom Objects<a class="headerlink" href="#StateAtom-Objects" title="Link to this heading"></a></h1>
<p>In PairInteraction we define <code class="docutils literal notranslate"><span class="pre">KetAtom</span></code> objects, which form the canonical basis using the atomic states defined by their quantum numbers. Ket objects are immutable and used to span the Hilbert space of the single atom system. In addition, we also define <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> objects, which can also represent arbitrary superpositions in the basis spanned by the <code class="docutils literal notranslate"><span class="pre">KetAtom</span></code> objects. In this tutorial we will show how to use the <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> object to create superposition states and calculate overlaps
with other states.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %pip install -q pairinteraction # Uncomment for installation on Colab</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pairinteraction</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pairinteraction.visualization.colormaps</span><span class="w"> </span><span class="kn">import</span> <span class="n">alphamagma</span>

<span class="k">if</span> <span class="n">pi</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">get_global_database</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">pi</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">initialize_global_database</span><span class="p">(</span><span class="n">download_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Simple-example:-create-a-superposition">
<h2>Simple example: create a superposition<a class="headerlink" href="#Simple-example:-create-a-superposition" title="Link to this heading"></a></h2>
<p>As a first example, we demonstrate how to create a superposition of two or more <code class="docutils literal notranslate"><span class="pre">KetAtom</span></code> objects. To do so, we first need to define a <code class="docutils literal notranslate"><span class="pre">BasisAtom</span></code>, in which the state will live. Then we can create a <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> corresponding to a single <code class="docutils literal notranslate"><span class="pre">KetAtom</span></code> by passing the ket and the basis to the <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> constructor.</p>
<p>Finally, you can add multiple <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> objects together or multiply them by a scalar by simply using the built-in operators <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">/</span></code>. If you want to calculate overlaps and expectation values, don’t forget to normalize the states using the <code class="docutils literal notranslate"><span class="pre">normalize()</span></code> method.</p>
<p>The coefficients of a <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> can be accessed using the <code class="docutils literal notranslate"><span class="pre">get_coefficients()</span></code> method, which returns a numpy array containing the coefficients in the order of the <code class="docutils literal notranslate"><span class="pre">KetAtom</span></code> objects in the basis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ket1</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">KetAtom</span><span class="p">(</span><span class="s2">&quot;Sr88_singlet&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">59</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">58</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ket of interest: </span><span class="si">{</span><span class="n">ket1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">BasisAtom</span><span class="p">(</span><span class="s2">&quot;Sr88_singlet&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="n">ket1</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ket1</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span> <span class="n">l</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of basis states: </span><span class="si">{</span><span class="n">basis</span><span class="o">.</span><span class="n">number_of_states</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">state1</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateAtom</span><span class="p">(</span><span class="n">ket1</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="c1"># this state only has one entry in its coefficient vector</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state1</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># this can also be seen by just printing the state</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State1: </span><span class="si">{</span><span class="n">state1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># To showcase addition, ... of two states we also define a second state</span>
<span class="n">ket2</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">KetAtom</span><span class="p">(</span><span class="s2">&quot;Sr88_singlet&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">58</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">58</span><span class="p">)</span>
<span class="n">state2</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateAtom</span><span class="p">(</span><span class="n">ket2</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State2: </span><span class="si">{</span><span class="n">state2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># now we can create a symmetric and anti-symmetric superposition of these two states</span>
<span class="n">state_plus</span> <span class="o">=</span> <span class="p">(</span><span class="n">state1</span> <span class="o">+</span> <span class="n">state2</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">state_minus</span> <span class="o">=</span> <span class="p">(</span><span class="n">state1</span> <span class="o">-</span> <span class="n">state2</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State plus: </span><span class="si">{</span><span class="n">state_plus</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State minus: </span><span class="si">{</span><span class="n">state_minus</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># and you can create any linear combination of as many states as you want</span>
<span class="n">ket3</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">KetAtom</span><span class="p">(</span><span class="s2">&quot;Sr88_singlet&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">57</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">57</span><span class="p">)</span>
<span class="n">state3</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateAtom</span><span class="p">(</span><span class="n">ket3</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">state1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">state2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">state3</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ket of interest: |Sr88_singlet:60,59_59,58⟩
Number of basis states: 449
state1.get_coefficients().nonzero()=(array([183]),)
State1: StateAtom(1.00 |Sr88_singlet:60,59_59,58⟩)
State2: StateAtom(1.00 |Sr88_singlet:60,58_58,58⟩)
State plus: StateAtom(0.71 |Sr88_singlet:60,58_58,58⟩ + 0.71 |Sr88_singlet:60,59_59,58⟩)
State minus: StateAtom(-0.71 |Sr88_singlet:60,58_58,58⟩ + 0.71 |Sr88_singlet:60,59_59,58⟩)
1.1 * state1 + 0.6 * state2 - 0.4 * state3 = StateAtom(1.10 |Sr88_singlet:60,59_59,58⟩ + 0.60 |Sr88_singlet:60,58_58,58⟩ + -0.40 |Sr88_singlet:60,57_57,57⟩)
</pre></div></div>
</div>
</section>
<section id="Use-state-objects-to-calculate-overlaps-and-expectation-values">
<h2>Use state objects to calculate overlaps and expectation values<a class="headerlink" href="#Use-state-objects-to-calculate-overlaps-and-expectation-values" title="Link to this heading"></a></h2>
<p>One can use the <code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> objects to calculate overlaps and expectation values. In PairInteraction, three kinds of objects can calculate overlaps (<code class="docutils literal notranslate"><span class="pre">get_overlap(s)</span></code>) and expectation values (<code class="docutils literal notranslate"><span class="pre">get_matrix_element(s)</span></code>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BasisAtom</span></code> / <code class="docutils literal notranslate"><span class="pre">BasisPair</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">get_overlaps(basis)</span></code> -&gt; returns a matrix containing all pair-wise overlaps between states of the two bases</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_overlaps(state)</span></code> -&gt; returns a vector containing the overlaps between all basis states and the given state</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_overlaps(ket)</span></code> -&gt; returns a vector containing the overlaps between all basis states and the given ket</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">StateAtom</span></code> / <code class="docutils literal notranslate"><span class="pre">StatePair</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">get_overlap(state)</span></code> -&gt; returns the overlap between this state and another state</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_overlap(ket)</span></code> -&gt; returns the overlap between this state and a ket</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">KetAtom</span></code> / <code class="docutils literal notranslate"><span class="pre">KetPair</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">get_overlap(ket)</span></code> -&gt; returns the overlap between this ket and another ket</p></li>
</ul>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ov</span> <span class="o">=</span> <span class="n">state_plus</span><span class="o">.</span><span class="n">get_overlap</span><span class="p">(</span><span class="n">ket1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overlap of state_plus with ket: </span><span class="si">{</span><span class="n">ov</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">state_plus</span><span class="o">.</span><span class="n">get_matrix_element</span><span class="p">(</span><span class="n">state_plus</span><span class="p">,</span> <span class="s2">&quot;electric_dipole&quot;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matrix element of state_plus with state_plus: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overlap of state_plus with ket: 0.4999999999999999
Matrix element of state_plus with state_plus: (-90.00056153827039+0j) atomic_unit_of_current * atomic_unit_of_time * bohr
</pre></div></div>
</div>
</section>
<section id="Stark-map-with-overlap-to-a-superposition-state">
<h2>Stark map with overlap to a superposition state<a class="headerlink" href="#Stark-map-with-overlap-to-a-superposition-state" title="Link to this heading"></a></h2>
<p>For circular states with an external electric field along the z-direction, the eigenstates are superpositions of states with different l but the same m quantum number.</p>
<p>For the special case defined above (ket1 with n=60, l=59, m=58 and ket2 with n=60, l=58, m=58), the eigenstates are the symmetric and antisymmetric superpositions of these two kets. This can be visualized by calculating the Stark map and the overlap of the eigenstates with these two superposition states.</p>
<p>Note for details on how to calculate Stark maps, see the tutorial <a class="reference internal" href="stark_map.html"><span class="doc">Stark maps</span></a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electric_fields</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">systems</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">pi</span><span class="o">.</span><span class="n">SystemAtom</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span><span class="o">.</span><span class="n">set_electric_field</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;V/cm&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">electric_fields</span>
<span class="p">]</span>

<span class="c1"># Diagonalize the systems in parallel</span>
<span class="n">pi</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">diagonalizer</span><span class="o">=</span><span class="s2">&quot;eigen&quot;</span><span class="p">,</span> <span class="n">float_type</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

<span class="n">eigenenergies</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">system</span><span class="o">.</span><span class="n">get_eigenenergies</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;GHz&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">ket1</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;GHz&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">systems</span>
<span class="p">]</span>
<span class="n">overlaps_plus</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_eigenbasis</span><span class="p">()</span><span class="o">.</span><span class="n">get_overlaps</span><span class="p">(</span><span class="n">state_plus</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">systems</span><span class="p">]</span>
<span class="n">overlaps_minus</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_eigenbasis</span><span class="p">()</span><span class="o">.</span><span class="n">get_overlaps</span><span class="p">(</span><span class="n">state_minus</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">systems</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x_repeated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
    <span class="p">[</span><span class="n">val</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">es</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">es</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">electric_fields</span><span class="p">,</span> <span class="n">eigenenergies</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">energies_flattened</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">eigenenergies</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">electric_fields</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eigenenergies</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># inhomogeneous shape -&gt; no simple line plot possible</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">es</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">electric_fields</span><span class="p">,</span> <span class="n">eigenenergies</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">es</span><span class="p">),</span> <span class="n">es</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Overlap with state plus&quot;</span><span class="p">)</span>
        <span class="n">overlaps_flattened</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">overlaps_plus</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Overlap with state minus&quot;</span><span class="p">)</span>
        <span class="n">overlaps_flattened</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">overlaps_minus</span><span class="p">)</span>

    <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">overlaps_flattened</span><span class="p">)</span>

    <span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x_repeated</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span>
        <span class="n">energies_flattened</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span>
        <span class="n">c</span><span class="o">=</span><span class="n">overlaps_flattened</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">alphamagma</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Overlap with state of interest&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Electric Field [V/cm]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [GHz]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_examples_python_state_atom_object_11_0.png" src="../../_images/tutorials_examples_python_state_atom_object_11_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="c3_c6_coefficients.html" class="btn btn-neutral float-left" title="\(C_3\) and \(C_6\) Coefficients" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="effective_hamiltonian.html" class="btn btn-neutral float-right" title="Effective Hamiltonian" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, PairInteraction Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    Version: master (dev)
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="../master/index.html">master (dev)</a></dd>
      
        <dd><a href="../stable/index.html">v2.3.1 (stable)</a></dd>
      
        <dd><a href="../v2.2.2/index.html">v2.2.2</a></dd>
      
        <dd><a href="../v2.1.0/index.html">v2.1.0</a></dd>
      
        <dd><a href="../v2.0.1/index.html">v2.0.1</a></dd>
      
        <dd><a href="../v0.9.10/index.html">v0.9.10 (legacy)</a></dd>
      
    </dl>
    
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>